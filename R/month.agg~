month.agg<-function(data,
		    process,
	    	    multiple=NULL,
		    na.rm=F){
	
	if(is.null(multiple)){
		warning("No multiple provided, aggregating to single months")
		multiple=1
	}	
	
	
	month<-aggregate(data$data,list(month=data$month,year=data$year),process,na.rm=na.rm)
	data.cols<-length(month)

	
	if(multiple>1){
		month$month<-month$month-month$month%%multiple
		for(i in 1:length(month[,1])){
			if(month[i,1]==0){
				month[i,1]=12-12%%multiple
				month[i,2]=month[i,2]-1
			}
		}
		date=strptime(paste(01,month$month,month$year),"%d %m %Y")
		results<-data.frame(date,data=month[,3:data.cols])
		return(results)
		}
	else{
		date=strptime(paste(01,month$month,month$year),"%d %m %Y")
		results<-data.frame(date,data=month[,3:data.cols])
		return(results)
	}
}
